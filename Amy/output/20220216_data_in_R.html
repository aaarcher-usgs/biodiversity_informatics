<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Working with data in R</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Working with data in R</h1>

<p>Biodiversity Informatics (BIOL 475/575)</p>

<p>February 16, 2022</p>

<p>Programmer: Amy</p>

<p>In this program, xxx</p>

<h3>Header</h3>

<pre><code class="r"># Load Libraries
library(ezknitr)

# Clear Environment &amp; Set Seed
remove(list=ls())
set.seed(71587)
</code></pre>

<hr/>

<h2>1. Finishing up basic R tasks</h2>

<h3>Subsetting and indexing in R</h3>

<p>Create a vector, x</p>

<pre><code class="r">x &lt;- c(56, 95.3, 0.4, 2.3, 4)
</code></pre>

<p>Add the second value of x to 4.7</p>

<pre><code class="r">x[2] + 4.7
</code></pre>

<pre><code>## [1] 100
</code></pre>

<p>What is the sixth value of x?</p>

<pre><code class="r">x[6]
</code></pre>

<pre><code>## [1] NA
</code></pre>

<p>Add names for x</p>

<pre><code class="r">names(x) &lt;- c(&quot;banana&quot;, &quot;coconut&quot;, &quot;blueberry&quot;, &quot;strawberry&quot;, &quot;kiwi&quot;)
</code></pre>

<p>Use the names to add the coconut&#39;s weight to 4.7</p>

<pre><code class="r">x[&quot;coconut&quot;] + 4.7
</code></pre>

<pre><code>## coconut 
##     100
</code></pre>

<p>Use the names to remove the non-tropical fruit</p>

<pre><code class="r"># One way:
x[c(&quot;banana&quot;, &quot;coconut&quot;, &quot;kiwi&quot;)]
</code></pre>

<pre><code>##  banana coconut    kiwi 
##    56.0    95.3     4.0
</code></pre>

<pre><code class="r"># Another way:
x[c( -3, -4 )]
</code></pre>

<pre><code>##  banana coconut    kiwi 
##    56.0    95.3     4.0
</code></pre>

<p>Sort the values of x by size (ascending) and print those, but don&#39;t overwrite x</p>

<pre><code class="r">sort(x, decreasing = FALSE)
</code></pre>

<pre><code>##  blueberry strawberry       kiwi     banana    coconut 
##        0.4        2.3        4.0       56.0       95.3
</code></pre>

<p>Sort the value of x by size (descending) and overwrite x with this new order</p>

<pre><code class="r">order(x, decreasing = TRUE)
</code></pre>

<pre><code>## [1] 2 1 5 4 3
</code></pre>

<pre><code class="r">(x &lt;- x[order(x, decreasing = TRUE)])
</code></pre>

<pre><code>##    coconut     banana       kiwi strawberry  blueberry 
##       95.3       56.0        4.0        2.3        0.4
</code></pre>

<p>Print the <em>logical</em> values of x where x is larger than 1</p>

<pre><code class="r">x &gt; 1
</code></pre>

<pre><code>##    coconut     banana       kiwi strawberry  blueberry 
##       TRUE       TRUE       TRUE       TRUE      FALSE
</code></pre>

<p>Use the same approach but now change any values less than 1 to <em>NA</em></p>

<pre><code class="r">x &lt; 1
</code></pre>

<pre><code>##    coconut     banana       kiwi strawberry  blueberry 
##      FALSE      FALSE      FALSE      FALSE       TRUE
</code></pre>

<pre><code class="r">x &lt;- ifelse(test = x &lt; 1, 
            yes = NA, 
            no = x )
</code></pre>

<p>Calculate the mean of the fruit that are less than 50 but more than 2</p>

<pre><code class="r">mean(x[x &lt; 50 &amp; x &gt; 2], na.rm = T)
</code></pre>

<pre><code>## [1] 3.15
</code></pre>

<p>Calculate the mean of the fruit that are equal to 4</p>

<pre><code class="r">mean(x[x == 4], na.rm = T)
</code></pre>

<pre><code>## [1] 4
</code></pre>

<h3>Practice exercises</h3>

<ol>
<li>Create a new vector named &ldquo;evens&rdquo; that includes all even numbers between 1 and 11.</li>
</ol>

<pre><code class="r">evens &lt;- c(2, 4, 6, 8 , 10)
</code></pre>

<ol>
<li>Create a new vector called &ldquo;odds&rdquo; by adding one to the &ldquo;evens&rdquo; vector</li>
<li>Determine if &ldquo;evens&rdquo; is a Numeric, Integer, Character, or Logical vector type</li>
<li>Change &ldquo;evens&rdquo; to a different vector type, making sure to show the results</li>
</ol>

<hr/>

<h2>2. Working with data in R</h2>

<p><em>Note:</em> Normally, we would load in all necessary data at the top of the script,
rather than down a ways. All libraries, necessary data, etc should be loaded 
in one place for reproducibility and for better troubleshooting.</p>

<p>Load in the dataset:</p>

<pre><code class="r">df.ex &lt;- read.csv(file = &quot;data/raw/Dataset_S1.txt&quot;)
</code></pre>

<p>Look at the structure of the data</p>

<pre><code class="r">str(df.ex)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    59140 obs. of  16 variables:
##  $ start          : int  55001 56001 57001 58001 59001 60001 61001 62001 63001 64001 ...
##  $ end            : int  56000 57000 58000 59000 60000 61000 62000 63000 64000 65000 ...
##  $ total.SNPs     : int  0 5 1 7 4 6 7 1 1 3 ...
##  $ total.Bases    : int  1894 6683 9063 10256 8057 7051 6950 8834 9629 7999 ...
##  $ depth          : num  3.41 6.68 9.06 10.26 8.06 ...
##  $ unique.SNPs    : int  0 2 1 3 4 2 2 1 1 1 ...
##  $ dhSNPs         : int  0 2 0 2 0 1 1 0 0 1 ...
##  $ reference.Bases: int  556 1000 1000 1000 1000 1000 1000 1000 1000 1000 ...
##  $ Theta          : num  0 8.01 3.51 9.93 12.91 ...
##  $ Pi             : num  0 10.35 1.99 9.56 8.51 ...
##  $ Heterozygosity : num  0 7.48 1.1 6.58 4.96 ...
##  $ X.GC           : num  54.8 42.4 37.2 38 41.3 ...
##  $ Recombination  : num  0.0096 0.0096 0.0096 0.0096 0.0096 ...
##  $ Divergence     : num  0.00301 0.01802 0.00701 0.01201 0.02402 ...
##  $ Constraint     : int  0 0 0 0 0 0 0 0 58 0 ...
##  $ SNPs           : int  0 0 0 0 0 0 0 0 1 1 ...
</code></pre>

<p>Note that the strings get loaded as factors by default. Change this:</p>

<pre><code class="r">df.ex &lt;- read.csv(file = &quot;data/raw/Dataset_S1.txt&quot;, stringsAsFactors = F)
</code></pre>

<p>View head (n = 3)</p>

<pre><code class="r">head(df.ex, n = 3)
</code></pre>

<pre><code>##   start   end total.SNPs total.Bases depth unique.SNPs dhSNPs reference.Bases Theta     Pi
## 1 55001 56000          0        1894  3.41           0      0             556 0.000  0.000
## 2 56001 57000          5        6683  6.68           2      2            1000 8.007 10.354
## 3 57001 58000          1        9063  9.06           1      0            1000 3.510  1.986
##   Heterozygosity    X.GC Recombination  Divergence Constraint SNPs
## 1          0.000 54.8096   0.009601574 0.003006012          0    0
## 2          7.481 42.4424   0.009601574 0.018018020          0    0
## 3          1.103 37.2372   0.009601574 0.007007007          0    0
</code></pre>

<p>Dimensions of a data frame come in &ldquo;rows, columns&rdquo;</p>

<pre><code class="r">dim(df.ex)
</code></pre>

<pre><code>## [1] 59140    16
</code></pre>

<pre><code class="r">nrow(df.ex)
</code></pre>

<pre><code>## [1] 59140
</code></pre>

<pre><code class="r">ncol(df.ex)
</code></pre>

<pre><code>## [1] 16
</code></pre>

<p>Query the column names for this dataset</p>

<pre><code class="r">colnames(df.ex)
</code></pre>

<pre><code>##  [1] &quot;start&quot;           &quot;end&quot;             &quot;total.SNPs&quot;      &quot;total.Bases&quot;     &quot;depth&quot;          
##  [6] &quot;unique.SNPs&quot;     &quot;dhSNPs&quot;          &quot;reference.Bases&quot; &quot;Theta&quot;           &quot;Pi&quot;             
## [11] &quot;Heterozygosity&quot;  &quot;X.GC&quot;            &quot;Recombination&quot;   &quot;Divergence&quot;      &quot;Constraint&quot;     
## [16] &quot;SNPs&quot;
</code></pre>

<p>Note that some column names don&#39;t make sense, change &ldquo;X.GC&rdquo; to &ldquo;percent.GC&rdquo;</p>

<pre><code class="r">colnames(df.ex) &lt;- ifelse(test = colnames(df.ex) == &quot;X.GC&quot;,
                          yes = &quot;percent.GC&quot;,
                          no = colnames(df.ex))
</code></pre>

<p>Use $ to access a single column. Specifically, calculate the average of the depth
column</p>

<pre><code class="r">mean(df.ex$depth)
</code></pre>

<pre><code>## [1] 8.183938
</code></pre>

<p>Now use subsetting square brackets to do the same thing:</p>

<pre><code class="r">mean(df.ex[ ,&quot;depth&quot;])
</code></pre>

<pre><code>## [1] 8.183938
</code></pre>

<p>Now, calculate the average of the depth column values, but only when depth 
is greater than 5. (Hint, we have to use subsetting again here, but to subset
only rows where depth &gt; 5.)</p>

<pre><code class="r">mean(df.ex[df.ex$depth &gt; 5,&quot;depth&quot;])
</code></pre>

<pre><code>## [1] 8.414036
</code></pre>

<p>While not very reproducible, let&#39;s just calculate the mean of the first 10
rows of the depth column. This time do it both with the $ operator AND with 
square brackets only.</p>

<pre><code class="r">mean(df.ex[1 : 10, &quot;depth&quot;])
</code></pre>

<pre><code>## [1] 7.793
</code></pre>

<pre><code class="r">mean(df.ex$depth [1:10])
</code></pre>

<pre><code>## [1] 7.793
</code></pre>

<p>Add on a new column that is a test (TRUE/FALSE) of whether the genetic window 
is in the centromere location (25,800,000 to 29,700,000).</p>

<pre><code class="r">cent.start &lt;- 25800000
cent.end &lt;- 29700000


df.ex$Centromere &lt;- NA #new column, just with missing variables
df.ex$Centromere &lt;- df.ex$start &gt;= cent.start &amp; df.ex$end &lt;= cent.end
</code></pre>

<p>Tally up the results using table()</p>

<pre><code class="r">table(df.ex$Centromere)
</code></pre>

<pre><code>## 
## FALSE  TRUE 
## 58455   685
</code></pre>

<p>Tally up the results using sum()</p>

<pre><code class="r">sum(df.ex$Centromere)
</code></pre>

<pre><code>## [1] 685
</code></pre>

<h3>Footer</h3>

<p>spin this with:
ezspin(file = &ldquo;Amy/programs/20220216_data_in_R.R&rdquo;,out_dir = &ldquo;Amy/output&rdquo;, fig_dir = &ldquo;figures&rdquo;,keep_md = FALSE, keep_rmd = FALSE)</p>

</body>

</html>
